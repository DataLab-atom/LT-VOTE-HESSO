---> ---cifar100---
---> Argument
    └> network     : resnet32
    └> epochs      : 200
    └> batch_size  : 128
    └> update_epoch: 1
    └> lr          : 0.1
    └> lr_decay    : 0.01
    └> momentum    : 0.9
    └> wd          : 0.0002
    └> nesterov    : False
    └> scheduler   : warmup
    └> warmup      : 5
    └> aug_prob    : 0.5
    └> cutout      : False
    └> cmo         : False
    └> posthoc_la  : False
    └> cuda        : True
    └> aug_type    : autoaug_cifar
    └> sim_type    : none
    └> max_d       : 30
    └> num_test    : 10
    └> accept_rate : 0.6
    └> verbose     : False
    └> use_norm    : False
    └> supper_classes: 10
    └> out         : ./logs/results/cifar100/ce@N_500_ir_100/hesso_LT-vote/cifar100/ce@N_500_ir_100/
    └> data_dir    : /home/data/
    └> workers     : 4
    └> seed        : None
    └> gpu         : 0
    └> dataset     : cifar100
    └> num_max     : 500
    └> imb_ratio   : 100
    └> num_experts : 3
    └> ride_distill: False
    └> ce          : True
    └> bs          : False
    └> bcl         : False
    └> ce_drw      : False
    └> ldam_drw    : False
    └> gml         : False
    └> kps         : False
    └> shike       : False
    └> mgda        : False
    └> cagrad      : True
    └> chs         : False
    └> pla         : False
    └> pcg         : False
    └> tasks       : ['ce']
    └> mgda_mode   : none
    └> base_beta   : 0.5
    └> llm         : False
    └> llm_name    : alibaba
    └> llm_mode    : 0
    └> out_cut     : True
    └> data_aug    : vanilla
    └> use_randaug : False
    └> cuda_upgrade: 1
    └> cuda_downgrade: 1
    └> hesso       : True
    └> isc         : LT-vote
    └> loss_fn     : ce
    └> num_class   : 100
1.16.2  opset= 21
==> Preparing imbalanced CIFAR-100
Files already downloaded and verified
autoaug_cifar
c set = tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10], dtype=torch.int32)
Operation set = tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10], dtype=torch.int32)
Files already downloaded and verified
#Train: 10847, #Test: 10000
[500, 477, 455, 434, 415, 396, 378, 361, 344, 328, 314, 299, 286, 273, 260, 248, 237, 226, 216, 206, 197, 188, 179, 171, 163, 156, 149, 142, 135, 129, 123, 118, 112, 107, 102, 98, 93, 89, 85, 81, 77, 74, 70, 67, 64, 61, 58, 56, 53, 51, 48, 46, 44, 42, 40, 38, 36, 35, 33, 32, 30, 29, 27, 26, 25, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 15, 14, 13, 13, 12, 12, 11, 11, 10, 10, 9, 9, 8, 8, 7, 7, 7, 6, 6, 6, 6, 5, 5, 5, 5]
==> creating resnet32
['ce']
==> creating resnet32
OTO graph constructor
graph build
LT-vote
Setup HESSO
Target redundant groups per period:  [0]
Max state: 1 // Min state: 0
0 4950
---> Epoch: [1 | 30]
    └> Max_state: 1, min_state: 0
    └> [Train]	Loss:	1.9337
    └> [test]	Task: [ce , cat_out]
    └> [Test]	Loss: [ 2.2568, 4.2050,] 	Acc:[  41.6733, 41.6733, ]
    └> [Stats]	Many: [ 0.5091, 0.5091,] Medium: [  0.4437, 0.4437,] Few: [ 0.2790, 0.2790,]
    └> [Best ]	Acc:	41.6733	Many:	50.9143	Medium:	44.3714	Few:	27.9000
    └> [Param]	LR:	0.10000000
Max state: 2 // Min state: 0
85 4950
---> Epoch: [2 | 30]
    └> Max_state: 2, min_state: 0
    └> [Train]	Loss:	1.8703
    └> [test]	Task: [ce , cat_out]
    └> [Test]	Loss: [ 2.2799, 4.2065,] 	Acc:[  41.3865, 41.3865, ]
    └> [Stats]	Many: [ 0.5257, 0.5257,] Medium: [  0.4323, 0.4323,] Few: [ 0.2680, 0.2680,]
    └> [Best ]	Acc:	41.6733	Many:	50.9143	Medium:	44.3714	Few:	27.9000
    └> [Param]	LR:	0.10000000
Max state: 3 // Min state: 0
170 4950
---> Epoch: [3 | 30]
    └> Max_state: 3, min_state: 0
    └> [Train]	Loss:	1.8473
    └> [test]	Task: [ce , cat_out]
    └> [Test]	Loss: [ 2.2976, 4.2062,] 	Acc:[  41.6238, 41.6238, ]
    └> [Stats]	Many: [ 0.5289, 0.5289,] Medium: [  0.4266, 0.4266,] Few: [ 0.2720, 0.2720,]
    └> [Best ]	Acc:	41.6733	Many:	50.9143	Medium:	44.3714	Few:	27.9000
    └> [Param]	LR:	0.10000000
Max state: 2 // Min state: 0
255 4950
---> Epoch: [4 | 30]
    └> Max_state: 2, min_state: 0
    └> [Train]	Loss:	1.8130
    └> [test]	Task: [ce , cat_out]
    └> [Test]	Loss: [ 2.2937, 4.2038,] 	Acc:[  41.9304, 41.9304, ]
    └> [Stats]	Many: [ 0.5291, 0.5291,] Medium: [  0.4414, 0.4414,] Few: [ 0.2623, 0.2623,]
    └> [Best ]	Acc:	41.9304	Many:	52.9143	Medium:	44.1429	Few:	26.2333
    └> [Param]	LR:	0.10000000
Max state: 3 // Min state: 0
340 4950
---> Epoch: [5 | 30]
    └> Max_state: 3, min_state: 0
    └> [Train]	Loss:	1.7991
    └> [test]	Task: [ce , cat_out]
    └> [Test]	Loss: [ 2.3212, 4.2013,] 	Acc:[  42.0392, 42.0392, ]
    └> [Stats]	Many: [ 0.5477, 0.5477,] Medium: [  0.4331, 0.4331,] Few: [ 0.2587, 0.2587,]
    └> [Best ]	Acc:	42.0392	Many:	54.7714	Medium:	43.3143	Few:	25.8667
    └> [Param]	LR:	0.10000000
Max state: 4 // Min state: 0
425 4950
---> Epoch: [6 | 30]
    └> Max_state: 4, min_state: 0
    └> [Train]	Loss:	1.7636
    └> [test]	Task: [ce , cat_out]
    └> [Test]	Loss: [ 2.3438, 4.2050,] 	Acc:[  41.7425, 41.7425, ]
    └> [Stats]	Many: [ 0.5334, 0.5334,] Medium: [  0.4454, 0.4454,] Few: [ 0.2487, 0.2487,]
    └> [Best ]	Acc:	42.0392	Many:	54.7714	Medium:	43.3143	Few:	25.8667
    └> [Param]	LR:	0.10000000
Max state: 5 // Min state: 0
510 4950
---> Epoch: [7 | 30]
    └> Max_state: 5, min_state: 0
    └> [Train]	Loss:	1.8136
    └> [test]	Task: [ce , cat_out]
    └> [Test]	Loss: [ 2.3732, 4.2077,] 	Acc:[  41.2678, 41.2678, ]
    └> [Stats]	Many: [ 0.5434, 0.5434,] Medium: [  0.4354, 0.4354,] Few: [ 0.2397, 0.2397,]
    └> [Best ]	Acc:	42.0392	Many:	54.7714	Medium:	43.3143	Few:	25.8667
    └> [Param]	LR:	0.10000000
Max state: 4 // Min state: 0
595 4950
---> Epoch: [8 | 30]
    └> Max_state: 4, min_state: 0
    └> [Train]	Loss:	1.7717
    └> [test]	Task: [ce , cat_out]
    └> [Test]	Loss: [ 2.3637, 4.2058,] 	Acc:[  41.5249, 41.5249, ]
    └> [Stats]	Many: [ 0.5489, 0.5489,] Medium: [  0.4231, 0.4231,] Few: [ 0.2540, 0.2540,]
    └> [Best ]	Acc:	42.0392	Many:	54.7714	Medium:	43.3143	Few:	25.8667
    └> [Param]	LR:	0.10000000
Max state: 5 // Min state: 0
680 4950
---> Epoch: [9 | 30]
    └> Max_state: 5, min_state: 0
    └> [Train]	Loss:	1.7431
    └> [test]	Task: [ce , cat_out]
    └> [Test]	Loss: [ 2.3848, 4.2084,] 	Acc:[  41.4062, 41.4062, ]
    └> [Stats]	Many: [ 0.5500, 0.5500,] Medium: [  0.4191, 0.4191,] Few: [ 0.2487, 0.2487,]
    └> [Best ]	Acc:	42.0392	Many:	54.7714	Medium:	43.3143	Few:	25.8667
    └> [Param]	LR:	0.10000000
Max state: 4 // Min state: 0
765 4950
---> Epoch: [10 | 30]
    └> Max_state: 4, min_state: 0
    └> [Train]	Loss:	1.7566
    └> [test]	Task: [ce , cat_out]
    └> [Test]	Loss: [ 2.4030, 4.2057,] 	Acc:[  41.6733, 41.6733, ]
    └> [Stats]	Many: [ 0.5463, 0.5463,] Medium: [  0.4243, 0.4243,] Few: [ 0.2560, 0.2560,]
    └> [Best ]	Acc:	42.0392	Many:	54.7714	Medium:	43.3143	Few:	25.8667
    └> [Param]	LR:	0.10000000
Max state: 5 // Min state: 0
850 4950
---> Epoch: [11 | 30]
    └> Max_state: 5, min_state: 0
    └> [Train]	Loss:	1.7890
    └> [test]	Task: [ce , cat_out]
    └> [Test]	Loss: [ 2.4012, 4.2078,] 	Acc:[  41.5348, 41.5348, ]
    └> [Stats]	Many: [ 0.5426, 0.5426,] Medium: [  0.4377, 0.4377,] Few: [ 0.2377, 0.2377,]
    └> [Best ]	Acc:	42.0392	Many:	54.7714	Medium:	43.3143	Few:	25.8667
    └> [Param]	LR:	0.10000000
Max state: 6 // Min state: 0
935 4950
---> Epoch: [12 | 30]
    └> Max_state: 6, min_state: 0
    └> [Train]	Loss:	1.7498
    └> [test]	Task: [ce , cat_out]
    └> [Test]	Loss: [ 2.3883, 4.2038,] 	Acc:[  41.8612, 41.8612, ]
    └> [Stats]	Many: [ 0.5423, 0.5423,] Medium: [  0.4394, 0.4394,] Few: [ 0.2493, 0.2493,]
    └> [Best ]	Acc:	42.0392	Many:	54.7714	Medium:	43.3143	Few:	25.8667
    └> [Param]	LR:	0.10000000
Max state: 7 // Min state: 0
1020 4950
---> Epoch: [13 | 30]
    └> Max_state: 7, min_state: 0
    └> [Train]	Loss:	1.7002
    └> [test]	Task: [ce , cat_out]
    └> [Test]	Loss: [ 2.4036, 4.2064,] 	Acc:[  41.6040, 41.6040, ]
    └> [Stats]	Many: [ 0.5494, 0.5494,] Medium: [  0.4369, 0.4369,] Few: [ 0.2353, 0.2353,]
    └> [Best ]	Acc:	42.0392	Many:	54.7714	Medium:	43.3143	Few:	25.8667
    └> [Param]	LR:	0.10000000
Max state: 8 // Min state: 0
1105 4950
---> Epoch: [14 | 30]
    └> Max_state: 8, min_state: 0
    └> [Train]	Loss:	1.7418
    └> [test]	Task: [ce , cat_out]
    └> [Test]	Loss: [ 2.4215, 4.2129,] 	Acc:[  40.8228, 40.8228, ]
    └> [Stats]	Many: [ 0.5471, 0.5471,] Medium: [  0.4223, 0.4223,] Few: [ 0.2333, 0.2333,]
    └> [Best ]	Acc:	42.0392	Many:	54.7714	Medium:	43.3143	Few:	25.8667
    └> [Param]	LR:	0.10000000
Max state: 9 // Min state: 0
1190 4950
---> Epoch: [15 | 30]
    └> Max_state: 9, min_state: 0
    └> [Train]	Loss:	1.7620
    └> [test]	Task: [ce , cat_out]
    └> [Test]	Loss: [ 2.4324, 4.2087,] 	Acc:[  41.3766, 41.3766, ]
    └> [Stats]	Many: [ 0.5369, 0.5369,] Medium: [  0.4431, 0.4431,] Few: [ 0.2350, 0.2350,]
    └> [Best ]	Acc:	42.0392	Many:	54.7714	Medium:	43.3143	Few:	25.8667
    └> [Param]	LR:	0.10000000
Max state: 8 // Min state: 0
1275 4950
---> Epoch: [16 | 30]
    └> Max_state: 8, min_state: 0
    └> [Train]	Loss:	1.7104
    └> [test]	Task: [ce , cat_out]
    └> [Test]	Loss: [ 2.4190, 4.2116,] 	Acc:[  40.9513, 40.9513, ]
    └> [Stats]	Many: [ 0.5434, 0.5434,] Medium: [  0.4286, 0.4286,] Few: [ 0.2347, 0.2347,]
    └> [Best ]	Acc:	42.0392	Many:	54.7714	Medium:	43.3143	Few:	25.8667
    └> [Param]	LR:	0.10000000
Max state: 7 // Min state: 0
1360 4950
---> Epoch: [17 | 30]
    └> Max_state: 7, min_state: 0
    └> [Train]	Loss:	1.7668
    └> [test]	Task: [ce , cat_out]
    └> [Test]	Loss: [ 2.4317, 4.2092,] 	Acc:[  41.3964, 41.3964, ]
    └> [Stats]	Many: [ 0.5377, 0.5377,] Medium: [  0.4374, 0.4374,] Few: [ 0.2390, 0.2390,]
    └> [Best ]	Acc:	42.0392	Many:	54.7714	Medium:	43.3143	Few:	25.8667
    └> [Param]	LR:	0.10000000
Max state: 8 // Min state: 0
1445 4950
---> Epoch: [18 | 30]
    └> Max_state: 8, min_state: 0
    └> [Train]	Loss:	1.7176
    └> [test]	Task: [ce , cat_out]
    └> [Test]	Loss: [ 2.4292, 4.2080,] 	Acc:[  41.5843, 41.5843, ]
    └> [Stats]	Many: [ 0.5486, 0.5486,] Medium: [  0.4314, 0.4314,] Few: [ 0.2373, 0.2373,]
    └> [Best ]	Acc:	42.0392	Many:	54.7714	Medium:	43.3143	Few:	25.8667
    └> [Param]	LR:	0.10000000
Max state: 9 // Min state: 0
1530 4950
---> Epoch: [19 | 30]
    └> Max_state: 9, min_state: 0
    └> [Train]	Loss:	1.7115
    └> [test]	Task: [ce , cat_out]
    └> [Test]	Loss: [ 2.4396, 4.2080,] 	Acc:[  41.1689, 41.1689, ]
    └> [Stats]	Many: [ 0.5434, 0.5434,] Medium: [  0.4331, 0.4331,] Few: [ 0.2413, 0.2413,]
    └> [Best ]	Acc:	42.0392	Many:	54.7714	Medium:	43.3143	Few:	25.8667
    └> [Param]	LR:	0.10000000
Max state: 10 // Min state: 0
1615 4950
---> Epoch: [20 | 30]
    └> Max_state: 10, min_state: 0
    └> [Train]	Loss:	1.7251
    └> [test]	Task: [ce , cat_out]
    └> [Test]	Loss: [ 2.4427, 4.2047,] 	Acc:[  41.8414, 41.8414, ]
    └> [Stats]	Many: [ 0.5537, 0.5537,] Medium: [  0.4377, 0.4377,] Few: [ 0.2350, 0.2350,]
    └> [Best ]	Acc:	42.0392	Many:	54.7714	Medium:	43.3143	Few:	25.8667
    └> [Param]	LR:	0.10000000
Max state: 10 // Min state: 0
1700 4950
---> Epoch: [21 | 30]
    └> Max_state: 10, min_state: 0
    └> [Train]	Loss:	1.7246
    └> [test]	Task: [ce , cat_out]
    └> [Test]	Loss: [ 2.4585, 4.2098,] 	Acc:[  41.4062, 41.4062, ]
    └> [Stats]	Many: [ 0.5557, 0.5557,] Medium: [  0.4280, 0.4280,] Few: [ 0.2270, 0.2270,]
    └> [Best ]	Acc:	42.0392	Many:	54.7714	Medium:	43.3143	Few:	25.8667
    └> [Param]	LR:	0.10000000
Max state: 10 // Min state: 0
1785 4950
---> Epoch: [22 | 30]
    └> Max_state: 10, min_state: 0
    └> [Train]	Loss:	1.7312
    └> [test]	Task: [ce , cat_out]
    └> [Test]	Loss: [ 2.4477, 4.2093,] 	Acc:[  41.3865, 41.3865, ]
    └> [Stats]	Many: [ 0.5437, 0.5437,] Medium: [  0.4346, 0.4346,] Few: [ 0.2350, 0.2350,]
    └> [Best ]	Acc:	42.0392	Many:	54.7714	Medium:	43.3143	Few:	25.8667
    └> [Param]	LR:	0.10000000
Max state: 9 // Min state: 0
1870 4950
---> Epoch: [23 | 30]
    └> Max_state: 9, min_state: 0
    └> [Train]	Loss:	1.7141
    └> [test]	Task: [ce , cat_out]
    └> [Test]	Loss: [ 2.4364, 4.2107,] 	Acc:[  41.1096, 41.1096, ]
    └> [Stats]	Many: [ 0.5400, 0.5400,] Medium: [  0.4303, 0.4303,] Few: [ 0.2397, 0.2397,]
    └> [Best ]	Acc:	42.0392	Many:	54.7714	Medium:	43.3143	Few:	25.8667
    └> [Param]	LR:	0.10000000
Max state: 8 // Min state: 0
1955 4950
---> Epoch: [24 | 30]
    └> Max_state: 8, min_state: 0
    └> [Train]	Loss:	1.6893
    └> [test]	Task: [ce , cat_out]
    └> [Test]	Loss: [ 2.4491, 4.2078,] 	Acc:[  41.4656, 41.4656, ]
    └> [Stats]	Many: [ 0.5354, 0.5354,] Medium: [  0.4426, 0.4426,] Few: [ 0.2403, 0.2403,]
    └> [Best ]	Acc:	42.0392	Many:	54.7714	Medium:	43.3143	Few:	25.8667
    └> [Param]	LR:	0.10000000
Max state: 9 // Min state: 0
2040 4950
---> Epoch: [25 | 30]
    └> Max_state: 9, min_state: 0
    └> [Train]	Loss:	1.6852
    └> [test]	Task: [ce , cat_out]
    └> [Test]	Loss: [ 2.4528, 4.2098,] 	Acc:[  41.3370, 41.3370, ]
    └> [Stats]	Many: [ 0.5449, 0.5449,] Medium: [  0.4291, 0.4291,] Few: [ 0.2383, 0.2383,]
    └> [Best ]	Acc:	42.0392	Many:	54.7714	Medium:	43.3143	Few:	25.8667
    └> [Param]	LR:	0.10000000
Max state: 8 // Min state: 0
2125 4950
---> Epoch: [26 | 30]
    └> Max_state: 8, min_state: 0
    └> [Train]	Loss:	1.7137
    └> [test]	Task: [ce , cat_out]
    └> [Test]	Loss: [ 2.4503, 4.2063,] 	Acc:[  41.5447, 41.5447, ]
    └> [Stats]	Many: [ 0.5454, 0.5454,] Medium: [  0.4440, 0.4440,] Few: [ 0.2320, 0.2320,]
    └> [Best ]	Acc:	42.0392	Many:	54.7714	Medium:	43.3143	Few:	25.8667
    └> [Param]	LR:	0.10000000
Max state: 9 // Min state: 0
2210 4950
---> Epoch: [27 | 30]
    └> Max_state: 9, min_state: 0
    └> [Train]	Loss:	1.7014
    └> [test]	Task: [ce , cat_out]
    └> [Test]	Loss: [ 2.4660, 4.2096,] 	Acc:[  41.3568, 41.3568, ]
    └> [Stats]	Many: [ 0.5409, 0.5409,] Medium: [  0.4349, 0.4349,] Few: [ 0.2370, 0.2370,]
    └> [Best ]	Acc:	42.0392	Many:	54.7714	Medium:	43.3143	Few:	25.8667
    └> [Param]	LR:	0.10000000
Max state: 10 // Min state: 0
2295 4950
---> Epoch: [28 | 30]
    └> Max_state: 10, min_state: 0
    └> [Train]	Loss:	1.7099
    └> [test]	Task: [ce , cat_out]
    └> [Test]	Loss: [ 2.4726, 4.2103,] 	Acc:[  41.0799, 41.0799, ]
    └> [Stats]	Many: [ 0.5611, 0.5611,] Medium: [  0.4191, 0.4191,] Few: [ 0.2293, 0.2293,]
    └> [Best ]	Acc:	42.0392	Many:	54.7714	Medium:	43.3143	Few:	25.8667
    └> [Param]	LR:	0.10000000
Max state: 9 // Min state: 0
2380 4950
---> Epoch: [29 | 30]
    └> Max_state: 9, min_state: 0
    └> [Train]	Loss:	1.7024
    └> [test]	Task: [ce , cat_out]
    └> [Test]	Loss: [ 2.4551, 4.2052,] 	Acc:[  41.6535, 41.6535, ]
    └> [Stats]	Many: [ 0.5469, 0.5469,] Medium: [  0.4434, 0.4434,] Few: [ 0.2347, 0.2347,]
    └> [Best ]	Acc:	42.0392	Many:	54.7714	Medium:	43.3143	Few:	25.8667
    └> [Param]	LR:	0.10000000
Max state: 8 // Min state: 0
2465 4950
---> Epoch: [30 | 30]
    └> Max_state: 8, min_state: 0
    └> [Train]	Loss:	1.7455
    └> [test]	Task: [ce , cat_out]
    └> [Test]	Loss: [ 2.4548, 4.2072,] 	Acc:[  41.5941, 41.5941, ]
    └> [Stats]	Many: [ 0.5423, 0.5423,] Medium: [  0.4460, 0.4460,] Few: [ 0.2303, 0.2303,]
    └> [Best ]	Acc:	42.0392	Many:	54.7714	Medium:	43.3143	Few:	25.8667
    └> [Param]	LR:	0.10000000
---> Final performance...
    └> best bAcc (test):	42.0392
    └> best statistics:	Many:	0.5477142333984375	Med:	0.43314284086227417	Few:	0.25866666436195374
---> Training Time: 0:03:43.80
---> FLOP  reduction (%) :  0.0  	 8848.703488000001  	 8848.703488000001 
---> Param reduction (%) :  0.0 	 0.472564	 0.472564
